{% extends "admin/base.html" %} {% block content %}
<div class="flex bg-white shadow-sm" style="height: 600px">
  <!-- Sidebar -->
  <div class="w-250 border-r bg-gray-50 flex flex-col">
    <!-- New Generation Section -->
    <div class="p-4 border-b">
      <h3 class="text-sm font-semibold text-gray-700 mb-3">📝 新建生成</h3>

      <!-- Question Input -->
      <div class="mb-3">
        <textarea
          id="question-input"
          placeholder="输入物理问题..."
          class="w-full h-20 p-2 text-sm border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        ></textarea>
        <!-- Input status will be added here by JS -->
      </div>

      <!-- Model Selection -->
      <div class="mb-3">
        <select
          id="model-select"
          class="w-full p-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
        >
          <option value="claude">Claude Sonnet 4</option>
          <option value="qwen">Qwen 3 Coder Plus</option>
        </select>
      </div>

      <!-- Generate Button -->
      <button
        id="generate-btn"
        class="w-full py-2 px-3 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"
      >
        🚀 生成
      </button>
    </div>

    <!-- History Section -->
    <div class="flex-1 flex flex-col">
      <div class="p-4 border-b">
        <h3 class="text-sm font-semibold text-gray-700 mb-3">📋 历史记录</h3>

        <!-- Search Input -->
        <div class="mb-3 relative">
          <input
            type="text"
            id="history-search"
            placeholder="搜索..."
            class="w-full p-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
          />
          <div class="absolute right-2 top-2 text-xs text-gray-400">
            <span class="shortcut-hint">Ctrl+K</span>
          </div>
        </div>
      </div>

      <!-- History List -->
      <div class="flex-1 overflow-y-auto">
        <div id="history-list" class="space-y-1 p-2">
          <!-- Loading state -->
          <div
            id="history-loading"
            class="text-center py-8 text-sm text-gray-500"
          >
            <div
              class="inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"
            ></div>
            <div class="mt-2">加载中...</div>
          </div>

          <!-- Empty state -->
          <div
            id="history-empty"
            class="text-center py-8 text-sm text-gray-500 hidden"
          >
            暂无历史记录
          </div>

          <!-- History items will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="flex-1 flex flex-col">
    <!-- Content Display -->
    <div class="flex-1 p-6 overflow-y-auto">
      <!-- Welcome State -->
      <div id="welcome-state" class="h-full flex items-center justify-center">
        <div class="text-center text-gray-500">
          <div class="text-6xl mb-4">🚀</div>
          <h2 class="text-xl font-semibold mb-2">
            欢迎使用 Physics Animation Admin
          </h2>
          <p class="text-sm">输入物理问题开始生成，或选择历史记录查看</p>
        </div>
      </div>

      <!-- Loading State -->
      <div id="loading-state" class="h-full items-center justify-center hidden">
        <div class="text-center">
          <div
            class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"
          ></div>
          <div class="text-gray-600">生成中，请稍候...</div>
        </div>
      </div>

      <!-- Content Display -->
      <div id="content-display" class="hidden">
        <!-- Question and Meta Info -->
        <div class="mb-6">
          <h2
            id="content-question"
            class="text-lg font-semibold text-gray-800 mb-2"
          ></h2>
          <div id="content-meta" class="text-sm text-gray-500"></div>
        </div>

        <!-- Physics Explanation -->
        <div class="mb-6">
          <h3 class="text-md font-semibold text-gray-700 mb-3">物理解释</h3>
          <div
            id="content-explanation"
            class="prose prose-sm max-w-none bg-gray-50 p-4 rounded-lg"
          ></div>
        </div>

        <!-- SVG Animation Section -->
        <div>
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-md font-semibold text-gray-700">SVG动画</h3>

            <!-- Tab Switcher -->
            <div class="flex bg-gray-100 rounded-md p-1">
              <button
                id="animation-tab"
                class="px-3 py-1 text-sm font-medium rounded transition-colors bg-white text-gray-700 shadow-sm"
              >
                🎨 动画
              </button>
              <button
                id="code-tab"
                class="px-3 py-1 text-sm font-medium rounded transition-colors text-gray-500 hover:text-gray-700"
              >
                📄 代码
              </button>
            </div>
          </div>

          <!-- Animation Display -->
          <div
            id="animation-view"
            class="border border-gray-200 rounded-lg bg-white p-4 min-h-80 flex items-center justify-center"
          >
            <div id="svg-container"></div>
          </div>

          <!-- Code Display -->
          <div
            id="code-view"
            class="border border-gray-200 rounded-lg bg-white p-4 min-h-80 hidden"
          >
            <pre
              class="text-sm overflow-auto max-h-72"
            ><code id="svg-code" class="language-markup"></code></pre>
            <div class="mt-3 pt-3 border-t border-gray-100 flex gap-2">
              <button
                id="copy-code-btn"
                class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors"
              >
                📋 复制代码
              </button>
              <button
                onclick="window.physicsAdmin.downloadSVG()"
                class="px-3 py-1 text-sm bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition-colors"
              >
                💾 下载SVG
              </button>
              <button
                onclick="window.physicsAdmin.exportHistory()"
                class="px-3 py-1 text-sm bg-green-100 text-green-600 rounded hover:bg-green-200 transition-colors"
              >
                📤 导出JSON
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Error State -->
      <div id="error-state" class="h-full items-center justify-center hidden">
        <div class="text-center text-red-500">
          <div class="text-6xl mb-4">❌</div>
          <h2 class="text-xl font-semibold mb-2">生成失败</h2>
          <p id="error-message" class="text-sm"></p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
